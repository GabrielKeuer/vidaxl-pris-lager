name: Benuta Inventory Sync

on:
  # KÃ¸r hver 1. time (10 minutter over)
  schedule:
    - cron: '10 */1 * * *'
  
  # Manuel trigger
  workflow_dispatch:

jobs:
  sync-benuta:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4
      
      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: ğŸ“¦ Install dependencies
        run: |
          pip install --upgrade pip
          pip install -r requirements.txt
      
      - name: ğŸ”„ Sync Benuta inventory
        env:
          SHOPIFY_STORE_URL: ${{ secrets.SHOPIFY_STORE_URL }}
          SHOPIFY_ACCESS_TOKEN: ${{ secrets.SHOPIFY_ACCESS_TOKEN }}
        run: |
          python scripts/sync_benuta_inventory.py
      
      - name: ğŸ“Š Upload logs
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: benuta-sync-logs-${{ github.run_number }}
          path: |
            *.log
          retention-days: 7
      
      - name: ğŸ”” Notify on failure
        if: failure()
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'âŒ Benuta Inventory Sync Failed',
              body: `Benuta inventory sync failed at ${new Date().toISOString()}\n\nCheck the [workflow run](${context.payload.repository.html_url}/actions/runs/${context.runId}) for details.`,
              labels: ['benuta', 'bug', 'automated']
            })

---

## ğŸ“‹ **Step 4: Test det manuelt**
1. GÃ¥ til **Actions** tab i GitHub
2. VÃ¦lg **Benuta Inventory Sync** workflow
3. Klik **Run workflow** â†’ **Run workflow**
4. Se logs i real-time

---

## ğŸ“Š **Fordele ved denne lÃ¸sning:**
âœ… **Simpel:** Opdaterer bare alt hver gang (da det er ~8,300 produkter)  
âœ… **Hurtig:** ~2-3 minutter total  
âœ… **Automatisk:** KÃ¸rer hver 1. time (10 minutter over)  
âœ… **FejlhÃ¥ndtering:** Logger alt og sender notifikationer  
âœ… **Samlet:** I samme repo som Sollux og VidaXL

---

## ğŸ”§ **Workflow oversigt:**
```
Hver time (10 over):
  â†“
ğŸ“¥ Download CSV fra Benuta
  â†“
ğŸ“‹ Parse 8,300+ produkter
  â†“
ğŸ“ Find Shopify location
  â†“
ğŸ” Match SKUs â†’ inventory IDs
  â†“
ğŸ”„ Opdater lager (100 per batch)
  â†“
ğŸ“Š Log resultater
  â†“
âœ… Done!
```
